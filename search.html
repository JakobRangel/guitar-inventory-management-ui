<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guitar Search</title>
</head>
<body>
    <label>Type:</label>
    <input id="type" />
    <button onclick="searchGuitars()">Search</button>
    <br />

    <table>
        <thead>
            <tr>
                <th>Serial Number</th>
                <th>Price</th>
                <th>Builder</th>
                <th>Model</th>
                <th>Type</th>
                <th>Back Wood</th>
                <th>Top Wood</th>
            </tr>
        </thead>
        <tbody id="searchResult">
        </tbody>
    </table>

    <script>
        let guitars = [];
        let host = "http://localhost:8080";

        async function getAll() {       
        return fetch(host + "/getall")
        .then(response => response.json())
        .catch(error => {
          console.log(error);
          alert("Something went wrong!");
          return [];
        });        
      }
        async function searchGuitars() {
            if(guitars.length == 0) {
            guitars = await getAll();
           }
            let guitarType = document.getElementById("type").value.toLowerCase(); // Convert input to lowercase
            let table = document.getElementById("searchResult");
            table.innerHTML = ""; // Clear existing results

            for(let guitar of guitars) {
                if(!guitarType || guitar.type.toLowerCase() === guitarType) { // Match by type
                    let row = document.createElement("tr");
                    Object.values(guitar).forEach(text => {
                        let cell = document.createElement("td");
                        cell.appendChild(document.createTextNode(text));
                        row.appendChild(cell);
                    });
                    table.appendChild(row);
                }
            }
        }
    </script>
</body>
</html>
